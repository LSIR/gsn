diff -Nurd wireshark-1.2.2.orig/configure.in wireshark-1.2.2/configure.in
--- wireshark-1.2.2.orig/configure.in	2009-11-26 15:35:09.000000000 +0100
+++ wireshark-1.2.2/configure.in	2009-11-26 15:37:04.000000000 +0100
@@ -1707,6 +1707,7 @@
   plugins/ethercat/Makefile
   plugins/giop/Makefile
   plugins/gryphon/Makefile
+  plugins/backlog/Makefile
   plugins/irda/Makefile
   plugins/m2m/Makefile
   plugins/mate/Makefile
diff -Nurd wireshark-1.2.2.orig/epan/Makefile.am wireshark-1.2.2/epan/Makefile.am
--- wireshark-1.2.2.orig/epan/Makefile.am	2009-11-26 15:35:04.000000000 +0100
+++ wireshark-1.2.2/epan/Makefile.am	2009-11-26 15:38:55.000000000 +0100
@@ -216,6 +216,7 @@
 	../plugins/giop/packet-cosnaming.c \
 	../plugins/giop/packet-coseventcomm.c \
 	../plugins/gryphon/packet-gryphon.c \
+	../plugins/backlog/packet-backlog.c \
 	../plugins/irda/packet-irda.c \
 	../plugins/m2m/packet-m2m.c \
 	../plugins/m2m/wimax_tlv.c \
diff -Nurd wireshark-1.2.2.orig/Makefile.am wireshark-1.2.2/Makefile.am
--- wireshark-1.2.2.orig/Makefile.am	2009-11-26 15:35:05.000000000 +0100
+++ wireshark-1.2.2/Makefile.am	2009-11-26 15:38:30.000000000 +0100
@@ -250,6 +250,7 @@
 	-dlopen plugins/giop/cosnaming.la \
 	-dlopen plugins/giop/coseventcomm.la \
 	-dlopen plugins/gryphon/gryphon.la \
+	-dlopen plugins/backlog/backlog.la \
 	-dlopen plugins/irda/irda.la \
 	-dlopen plugins/m2m/m2m.la \
 	-dlopen plugins/mate/mate.la \
diff -Nurd wireshark-1.2.2.orig/packaging/nsis/Makefile.nmake wireshark-1.2.2/packaging/nsis/Makefile.nmake
--- wireshark-1.2.2.orig/packaging/nsis/Makefile.nmake	2009-11-26 15:35:08.000000000 +0100
+++ wireshark-1.2.2/packaging/nsis/Makefile.nmake	2009-11-26 15:39:15.000000000 +0100
@@ -51,6 +51,7 @@
 	../../plugins/giop/parlay.dll \
 	../../plugins/giop/tango.dll \
 	../../plugins/gryphon/gryphon.dll \
+	../../plugins/backlog/backlog.dll \
 	../../plugins/irda/irda.dll \
 	../../plugins/m2m/m2m.dll \
 	../../plugins/mate/mate.dll \
diff -Nurd wireshark-1.2.2.orig/packaging/nsis/wireshark.nsi wireshark-1.2.2/packaging/nsis/wireshark.nsi
--- wireshark-1.2.2.orig/packaging/nsis/wireshark.nsi	2009-11-26 15:35:08.000000000 +0100
+++ wireshark-1.2.2/packaging/nsis/wireshark.nsi	2009-11-26 15:39:21.000000000 +0100
@@ -817,6 +817,7 @@
 File "..\..\plugins\giop\parlay.dll"
 File "..\..\plugins\giop\tango.dll"
 File "..\..\plugins\gryphon\gryphon.dll"
+File "..\..\plugins\backlog\backlog.dll"
 File "..\..\plugins\irda\irda.dll"
 File "..\..\plugins\m2m\m2m.dll"
 File "..\..\plugins\opcua\opcua.dll"
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/AUTHORS wireshark-1.2.2/plugins/backlog/AUTHORS
--- wireshark-1.2.2.orig/plugins/backlog/AUTHORS	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/AUTHORS	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1 @@
+Mustafa Yuecel <yuecel@tik.ee.ethz.ch>
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/COPYING wireshark-1.2.2/plugins/backlog/COPYING
--- wireshark-1.2.2.orig/plugins/backlog/COPYING	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/COPYING	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,340 @@
+		    GNU GENERAL PUBLIC LICENSE
+		       Version 2, June 1991
+
+ Copyright (C) 1989, 1991 Free Software Foundation, Inc.
+     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ Everyone is permitted to copy and distribute verbatim copies
+ of this license document, but changing it is not allowed.
+
+			    Preamble
+
+  The licenses for most software are designed to take away your
+freedom to share and change it.  By contrast, the GNU General Public
+License is intended to guarantee your freedom to share and change free
+software--to make sure the software is free for all its users.  This
+General Public License applies to most of the Free Software
+Foundation's software and to any other program whose authors commit to
+using it.  (Some other Free Software Foundation software is covered by
+the GNU Library General Public License instead.)  You can apply it to
+your programs, too.
+
+  When we speak of free software, we are referring to freedom, not
+price.  Our General Public Licenses are designed to make sure that you
+have the freedom to distribute copies of free software (and charge for
+this service if you wish), that you receive source code or can get it
+if you want it, that you can change the software or use pieces of it
+in new free programs; and that you know you can do these things.
+
+  To protect your rights, we need to make restrictions that forbid
+anyone to deny you these rights or to ask you to surrender the rights.
+These restrictions translate to certain responsibilities for you if you
+distribute copies of the software, or if you modify it.
+
+  For example, if you distribute copies of such a program, whether
+gratis or for a fee, you must give the recipients all the rights that
+you have.  You must make sure that they, too, receive or can get the
+source code.  And you must show them these terms so they know their
+rights.
+
+  We protect your rights with two steps: (1) copyright the software, and
+(2) offer you this license which gives you legal permission to copy,
+distribute and/or modify the software.
+
+  Also, for each author's protection and ours, we want to make certain
+that everyone understands that there is no warranty for this free
+software.  If the software is modified by someone else and passed on, we
+want its recipients to know that what they have is not the original, so
+that any problems introduced by others will not reflect on the original
+authors' reputations.
+
+  Finally, any free program is threatened constantly by software
+patents.  We wish to avoid the danger that redistributors of a free
+program will individually obtain patent licenses, in effect making the
+program proprietary.  To prevent this, we have made it clear that any
+patent must be licensed for everyone's free use or not licensed at all.
+
+  The precise terms and conditions for copying, distribution and
+modification follow.
+
+		    GNU GENERAL PUBLIC LICENSE
+   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
+
+  0. This License applies to any program or other work which contains
+a notice placed by the copyright holder saying it may be distributed
+under the terms of this General Public License.  The "Program", below,
+refers to any such program or work, and a "work based on the Program"
+means either the Program or any derivative work under copyright law:
+that is to say, a work containing the Program or a portion of it,
+either verbatim or with modifications and/or translated into another
+language.  (Hereinafter, translation is included without limitation in
+the term "modification".)  Each licensee is addressed as "you".
+
+Activities other than copying, distribution and modification are not
+covered by this License; they are outside its scope.  The act of
+running the Program is not restricted, and the output from the Program
+is covered only if its contents constitute a work based on the
+Program (independent of having been made by running the Program).
+Whether that is true depends on what the Program does.
+
+  1. You may copy and distribute verbatim copies of the Program's
+source code as you receive it, in any medium, provided that you
+conspicuously and appropriately publish on each copy an appropriate
+copyright notice and disclaimer of warranty; keep intact all the
+notices that refer to this License and to the absence of any warranty;
+and give any other recipients of the Program a copy of this License
+along with the Program.
+
+You may charge a fee for the physical act of transferring a copy, and
+you may at your option offer warranty protection in exchange for a fee.
+
+  2. You may modify your copy or copies of the Program or any portion
+of it, thus forming a work based on the Program, and copy and
+distribute such modifications or work under the terms of Section 1
+above, provided that you also meet all of these conditions:
+
+    a) You must cause the modified files to carry prominent notices
+    stating that you changed the files and the date of any change.
+
+    b) You must cause any work that you distribute or publish, that in
+    whole or in part contains or is derived from the Program or any
+    part thereof, to be licensed as a whole at no charge to all third
+    parties under the terms of this License.
+
+    c) If the modified program normally reads commands interactively
+    when run, you must cause it, when started running for such
+    interactive use in the most ordinary way, to print or display an
+    announcement including an appropriate copyright notice and a
+    notice that there is no warranty (or else, saying that you provide
+    a warranty) and that users may redistribute the program under
+    these conditions, and telling the user how to view a copy of this
+    License.  (Exception: if the Program itself is interactive but
+    does not normally print such an announcement, your work based on
+    the Program is not required to print an announcement.)
+
+These requirements apply to the modified work as a whole.  If
+identifiable sections of that work are not derived from the Program,
+and can be reasonably considered independent and separate works in
+themselves, then this License, and its terms, do not apply to those
+sections when you distribute them as separate works.  But when you
+distribute the same sections as part of a whole which is a work based
+on the Program, the distribution of the whole must be on the terms of
+this License, whose permissions for other licensees extend to the
+entire whole, and thus to each and every part regardless of who wrote it.
+
+Thus, it is not the intent of this section to claim rights or contest
+your rights to work written entirely by you; rather, the intent is to
+exercise the right to control the distribution of derivative or
+collective works based on the Program.
+
+In addition, mere aggregation of another work not based on the Program
+with the Program (or with a work based on the Program) on a volume of
+a storage or distribution medium does not bring the other work under
+the scope of this License.
+
+  3. You may copy and distribute the Program (or a work based on it,
+under Section 2) in object code or executable form under the terms of
+Sections 1 and 2 above provided that you also do one of the following:
+
+    a) Accompany it with the complete corresponding machine-readable
+    source code, which must be distributed under the terms of Sections
+    1 and 2 above on a medium customarily used for software interchange; or,
+
+    b) Accompany it with a written offer, valid for at least three
+    years, to give any third party, for a charge no more than your
+    cost of physically performing source distribution, a complete
+    machine-readable copy of the corresponding source code, to be
+    distributed under the terms of Sections 1 and 2 above on a medium
+    customarily used for software interchange; or,
+
+    c) Accompany it with the information you received as to the offer
+    to distribute corresponding source code.  (This alternative is
+    allowed only for noncommercial distribution and only if you
+    received the program in object code or executable form with such
+    an offer, in accord with Subsection b above.)
+
+The source code for a work means the preferred form of the work for
+making modifications to it.  For an executable work, complete source
+code means all the source code for all modules it contains, plus any
+associated interface definition files, plus the scripts used to
+control compilation and installation of the executable.  However, as a
+special exception, the source code distributed need not include
+anything that is normally distributed (in either source or binary
+form) with the major components (compiler, kernel, and so on) of the
+operating system on which the executable runs, unless that component
+itself accompanies the executable.
+
+If distribution of executable or object code is made by offering
+access to copy from a designated place, then offering equivalent
+access to copy the source code from the same place counts as
+distribution of the source code, even though third parties are not
+compelled to copy the source along with the object code.
+
+  4. You may not copy, modify, sublicense, or distribute the Program
+except as expressly provided under this License.  Any attempt
+otherwise to copy, modify, sublicense or distribute the Program is
+void, and will automatically terminate your rights under this License.
+However, parties who have received copies, or rights, from you under
+this License will not have their licenses terminated so long as such
+parties remain in full compliance.
+
+  5. You are not required to accept this License, since you have not
+signed it.  However, nothing else grants you permission to modify or
+distribute the Program or its derivative works.  These actions are
+prohibited by law if you do not accept this License.  Therefore, by
+modifying or distributing the Program (or any work based on the
+Program), you indicate your acceptance of this License to do so, and
+all its terms and conditions for copying, distributing or modifying
+the Program or works based on it.
+
+  6. Each time you redistribute the Program (or any work based on the
+Program), the recipient automatically receives a license from the
+original licensor to copy, distribute or modify the Program subject to
+these terms and conditions.  You may not impose any further
+restrictions on the recipients' exercise of the rights granted herein.
+You are not responsible for enforcing compliance by third parties to
+this License.
+
+  7. If, as a consequence of a court judgment or allegation of patent
+infringement or for any other reason (not limited to patent issues),
+conditions are imposed on you (whether by court order, agreement or
+otherwise) that contradict the conditions of this License, they do not
+excuse you from the conditions of this License.  If you cannot
+distribute so as to satisfy simultaneously your obligations under this
+License and any other pertinent obligations, then as a consequence you
+may not distribute the Program at all.  For example, if a patent
+license would not permit royalty-free redistribution of the Program by
+all those who receive copies directly or indirectly through you, then
+the only way you could satisfy both it and this License would be to
+refrain entirely from distribution of the Program.
+
+If any portion of this section is held invalid or unenforceable under
+any particular circumstance, the balance of the section is intended to
+apply and the section as a whole is intended to apply in other
+circumstances.
+
+It is not the purpose of this section to induce you to infringe any
+patents or other property right claims or to contest validity of any
+such claims; this section has the sole purpose of protecting the
+integrity of the free software distribution system, which is
+implemented by public license practices.  Many people have made
+generous contributions to the wide range of software distributed
+through that system in reliance on consistent application of that
+system; it is up to the author/donor to decide if he or she is willing
+to distribute software through any other system and a licensee cannot
+impose that choice.
+
+This section is intended to make thoroughly clear what is believed to
+be a consequence of the rest of this License.
+
+  8. If the distribution and/or use of the Program is restricted in
+certain countries either by patents or by copyrighted interfaces, the
+original copyright holder who places the Program under this License
+may add an explicit geographical distribution limitation excluding
+those countries, so that distribution is permitted only in or among
+countries not thus excluded.  In such case, this License incorporates
+the limitation as if written in the body of this License.
+
+  9. The Free Software Foundation may publish revised and/or new versions
+of the General Public License from time to time.  Such new versions will
+be similar in spirit to the present version, but may differ in detail to
+address new problems or concerns.
+
+Each version is given a distinguishing version number.  If the Program
+specifies a version number of this License which applies to it and "any
+later version", you have the option of following the terms and conditions
+either of that version or of any later version published by the Free
+Software Foundation.  If the Program does not specify a version number of
+this License, you may choose any version ever published by the Free Software
+Foundation.
+
+  10. If you wish to incorporate parts of the Program into other free
+programs whose distribution conditions are different, write to the author
+to ask for permission.  For software which is copyrighted by the Free
+Software Foundation, write to the Free Software Foundation; we sometimes
+make exceptions for this.  Our decision will be guided by the two goals
+of preserving the free status of all derivatives of our free software and
+of promoting the sharing and reuse of software generally.
+
+			    NO WARRANTY
+
+  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
+FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
+OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
+PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
+OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
+MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
+TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
+PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
+REPAIR OR CORRECTION.
+
+  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
+WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
+REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
+INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
+OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
+TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
+YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
+PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
+POSSIBILITY OF SUCH DAMAGES.
+
+		     END OF TERMS AND CONDITIONS
+
+	    How to Apply These Terms to Your New Programs
+
+  If you develop a new program, and you want it to be of the greatest
+possible use to the public, the best way to achieve this is to make it
+free software which everyone can redistribute and change under these terms.
+
+  To do so, attach the following notices to the program.  It is safest
+to attach them to the start of each source file to most effectively
+convey the exclusion of warranty; and each file should have at least
+the "copyright" line and a pointer to where the full notice is found.
+
+    <one line to give the program's name and a brief idea of what it does.>
+    Copyright (C) <year>  <name of author>
+
+    This program is free software; you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation; either version 2 of the License, or
+    (at your option) any later version.
+
+    This program is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with this program; if not, write to the Free Software
+    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+
+
+Also add information on how to contact you by electronic and paper mail.
+
+If the program is interactive, make it output a short notice like this
+when it starts in an interactive mode:
+
+    Gnomovision version 69, Copyright (C) year  name of author
+    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
+    This is free software, and you are welcome to redistribute it
+    under certain conditions; type `show c' for details.
+
+The hypothetical commands `show w' and `show c' should show the appropriate
+parts of the General Public License.  Of course, the commands you use may
+be called something other than `show w' and `show c'; they could even be
+mouse-clicks or menu items--whatever suits your program.
+
+You should also get your employer (if you work as a programmer) or your
+school, if any, to sign a "copyright disclaimer" for the program, if
+necessary.  Here is a sample; alter the names:
+
+  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
+  `Gnomovision' (which makes passes at compilers) written by James Hacker.
+
+  <signature of Ty Coon>, 1 April 1989
+  Ty Coon, President of Vice
+
+This General Public License does not permit incorporating your program into
+proprietary programs.  If your program is a subroutine library, you may
+consider it more useful to permit linking proprietary applications with the
+library.  If this is what you want to do, use the GNU Library General
+Public License instead of this License.
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/Makefile.am wireshark-1.2.2/plugins/backlog/Makefile.am
--- wireshark-1.2.2.orig/plugins/backlog/Makefile.am	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/Makefile.am	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,129 @@
+# Makefile.am
+# Automake file for Gryphon plugin
+# By Steve Limkemann <stevelim@dgtech.com>
+# Copyright 1998 Steve Limkemann
+#
+# $Id: Makefile.am 25863 2008-07-29 22:06:37Z morriss $
+#
+# Wireshark - Network traffic analyzer
+# By Gerald Combs <gerald@wireshark.org>
+# Copyright 1998 Gerald Combs
+# 
+# This program is free software; you can redistribute it and/or
+# modify it under the terms of the GNU General Public License
+# as published by the Free Software Foundation; either version 2
+# of the License, or (at your option) any later version.
+# 
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+# 
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+#
+
+INCLUDES = -I$(top_srcdir) -I$(includedir)
+
+include Makefile.common
+
+if HAVE_WARNINGS_AS_ERRORS
+AM_CFLAGS = -Werror
+endif
+
+plugindir = @plugindir@
+
+plugin_LTLIBRARIES = backlog.la
+backlog_la_SOURCES = \
+	plugin.c \
+	moduleinfo.h \
+	$(DISSECTOR_SRC) \
+	$(DISSECTOR_INCLUDES)
+backlog_la_LDFLAGS = -module -avoid-version
+backlog_la_LIBADD = @PLUGIN_LIBS@
+
+# Libs must be cleared, or else libtool won't create a shared module.
+# If your module needs to be linked against any particular libraries,
+# add them here.
+LIBS =
+
+#
+# Build plugin.c, which contains the plugin version[] string, a
+# function plugin_register() that calls the register routines for all
+# protocols, and a function plugin_reg_handoff() that calls the handoff
+# registration routines for all protocols.
+#
+# We do this by scanning sources.  If that turns out to be too slow,
+# maybe we could just require every .o file to have an register routine
+# of a given name (packet-aarp.o -> proto_register_aarp, etc.).
+#
+# Formatting conventions:  The name of the proto_register_* routines an
+# proto_reg_handoff_* routines must start in column zero, or must be
+# preceded only by "void " starting in column zero, and must not be
+# inside #if.
+#
+# DISSECTOR_SRC is assumed to have all the files that need to be scanned.
+#
+# For some unknown reason, having a big "for" loop in the Makefile
+# to scan all the files doesn't work with some "make"s; they seem to
+# pass only the first few names in the list to the shell, for some
+# reason.
+#
+# Therefore, we have a script to generate the plugin.c file.
+# The shell script runs slowly, as multiple greps and seds are run
+# for each input file; this is especially slow on Windows.  Therefore,
+# if Python is present (as indicated by PYTHON being defined), we run
+# a faster Python script to do that work instead.
+#
+# The first argument is the directory in which the source files live.
+# The second argument is "plugin", to indicate that we should build
+# a plugin.c file for a plugin.
+# All subsequent arguments are the files to scan.
+#
+plugin.c: $(DISSECTOR_SRC) $(top_srcdir)/tools/make-dissector-reg \
+    $(top_srcdir)/tools/make-dissector-reg.py
+	@if test -n "$(PYTHON)"; then \
+		echo Making plugin.c with python ; \
+		$(PYTHON) $(top_srcdir)/tools/make-dissector-reg.py $(srcdir) \
+		    plugin $(DISSECTOR_SRC) ; \
+	else \
+		echo Making plugin.c with shell script ; \
+		$(top_srcdir)/tools/make-dissector-reg $(srcdir) \
+		    $(plugin_src) plugin $(DISSECTOR_SRC) ; \
+	fi
+
+#
+# Currently plugin.c can be included in the distribution because
+# we always build all protocol dissectors. We used to have to check
+# whether or not to build the snmp dissector. If we again need to
+# variably build something, making plugin.c non-portable, uncomment
+# the dist-hook line below.
+#
+# Oh, yuk.  We don't want to include "plugin.c" in the distribution, as
+# its contents depend on the configuration, and therefore we want it
+# to be built when the first "make" is done; however, Automake insists
+# on putting *all* source into the distribution.
+#
+# We work around this by having a "dist-hook" rule that deletes
+# "plugin.c", so that "dist" won't pick it up.
+#
+#dist-hook:
+#	@rm -f $(distdir)/plugin.c
+
+CLEANFILES = \
+	backlog \
+	*~
+
+MAINTAINERCLEANFILES = \
+	Makefile.in	\
+	plugin.c
+
+EXTRA_DIST = \
+	Makefile.common		\
+	Makefile.nmake		\
+	moduleinfo.nmake	\
+	plugin.rc.in
+
+checkapi:
+	$(PERL) $(top_srcdir)/tools/checkAPIs.pl -g abort -g termoutput $(DISSECTOR_SRC)
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/Makefile.common wireshark-1.2.2/plugins/backlog/Makefile.common
--- wireshark-1.2.2.orig/plugins/backlog/Makefile.common	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/Makefile.common	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,40 @@
+# Makefile.common for Gryphon plugin
+#     Contains the stuff from Makefile.am and Makefile.nmake that is
+#     a) common to both files and
+#     b) portable between both files
+#
+# $Id: Makefile.common 27491 2009-02-21 16:33:48Z jake $
+#
+# Wireshark - Network traffic analyzer
+# By Gerald Combs <gerald@wireshark.org>
+# Copyright 1998 Gerald Combs
+#
+# This program is free software; you can redistribute it and/or
+# modify it under the terms of the GNU General Public License
+# as published by the Free Software Foundation; either version 2
+# of the License, or (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+
+# the name of the plugin
+PLUGIN_NAME = backlog
+
+# the dissector sources (without any helpers)
+DISSECTOR_SRC = \
+	packet-backlog.c
+
+# corresponding headers
+DISSECTOR_INCLUDES =	\
+	packet-backlog.h
+
+# Dissector helpers. They're included in the source files in this
+# directory, but they're not dissectors themselves, i.e. they're not
+# used to generate "plugin.c".
+DISSECTOR_SUPPORT_SRC =
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/Makefile.nmake wireshark-1.2.2/plugins/backlog/Makefile.nmake
--- wireshark-1.2.2.orig/plugins/backlog/Makefile.nmake	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/Makefile.nmake	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,103 @@
+# Makefile.nmake
+# nmake file for Wireshark plugin
+#
+# $Id: Makefile.nmake 27579 2009-03-02 18:57:35Z gerald $
+#
+
+include ..\..\config.nmake
+include moduleinfo.nmake
+
+include Makefile.common
+
+CFLAGS=/WX /DHAVE_CONFIG_H /I../.. $(GLIB_CFLAGS) \
+	/I$(PCAP_DIR)\include -D_U_="" $(LOCAL_CFLAGS)
+
+.c.obj::
+	$(CC) $(CFLAGS) -Fd.\ -c $<
+
+LDFLAGS = $(PLUGIN_LDFLAGS)
+
+!IFDEF ENABLE_LIBWIRESHARK
+LINK_PLUGIN_WITH=..\..\epan\libwireshark.lib
+CFLAGS=/DHAVE_WIN32_LIBWIRESHARK_LIB /D_NEED_VAR_IMPORT_ $(CFLAGS)
+
+DISSECTOR_OBJECTS = $(DISSECTOR_SRC:.c=.obj)
+
+DISSECTOR_SUPPORT_OBJECTS = $(DISSECTOR_SUPPORT_SRC:.c=.obj)
+
+OBJECTS = $(DISSECTOR_OBJECTS) $(DISSECTOR_SUPPORT_OBJECTS) plugin.obj
+
+RESOURCE=$(PLUGIN_NAME).res
+
+all: $(PLUGIN_NAME).dll
+
+$(PLUGIN_NAME).rc : moduleinfo.nmake
+	sed -e s/@PLUGIN_NAME@/$(PLUGIN_NAME)/ \
+	-e s/@RC_MODULE_VERSION@/$(RC_MODULE_VERSION)/ \
+	-e s/@RC_VERSION@/$(RC_VERSION)/ \
+	-e s/@MODULE_VERSION@/$(MODULE_VERSION)/ \
+	-e s/@PACKAGE@/$(PACKAGE)/ \
+	-e s/@VERSION@/$(VERSION)/ \
+	-e s/@MSVC_VARIANT@/$(MSVC_VARIANT)/ \
+	< plugin.rc.in > $@
+
+$(PLUGIN_NAME).dll $(PLUGIN_NAME).exp $(PLUGIN_NAME).lib : $(OBJECTS) $(LINK_PLUGIN_WITH) $(RESOURCE)
+	link -dll /out:$(PLUGIN_NAME).dll $(LDFLAGS) $(OBJECTS) $(LINK_PLUGIN_WITH) \
+	$(GLIB_LIBS) $(RESOURCE)
+
+#
+# Build plugin.c, which contains the plugin version[] string, a
+# function plugin_register() that calls the register routines for all
+# protocols, and a function plugin_reg_handoff() that calls the handoff
+# registration routines for all protocols.
+#
+# We do this by scanning sources.  If that turns out to be too slow,
+# maybe we could just require every .o file to have an register routine
+# of a given name (packet-aarp.o -> proto_register_aarp, etc.).
+#
+# Formatting conventions:  The name of the proto_register_* routines an
+# proto_reg_handoff_* routines must start in column zero, or must be
+# preceded only by "void " starting in column zero, and must not be
+# inside #if.
+#
+# DISSECTOR_SRC is assumed to have all the files that need to be scanned.
+#
+# For some unknown reason, having a big "for" loop in the Makefile
+# to scan all the files doesn't work with some "make"s; they seem to
+# pass only the first few names in the list to the shell, for some
+# reason.
+#
+# Therefore, we have a script to generate the plugin.c file.
+# The shell script runs slowly, as multiple greps and seds are run
+# for each input file; this is especially slow on Windows.  Therefore,
+# if Python is present (as indicated by PYTHON being defined), we run
+# a faster Python script to do that work instead.
+#
+# The first argument is the directory in which the source files live.
+# The second argument is "plugin", to indicate that we should build
+# a plugin.c file for a plugin.
+# All subsequent arguments are the files to scan.
+#
+!IFDEF PYTHON
+plugin.c: $(DISSECTOR_SRC) moduleinfo.h ../../tools/make-dissector-reg.py
+	@echo Making plugin.c (using python)
+	@$(PYTHON) "../../tools/make-dissector-reg.py" . plugin $(DISSECTOR_SRC)
+!ELSE
+plugin.c: $(DISSECTOR_SRC) moduleinfo.h ../../tools/make-dissector-reg
+	@echo Making plugin.c (using sh)
+	@$(SH) ../../tools/make-dissector-reg . plugin $(DISSECTOR_SRC)
+!ENDIF
+
+!ENDIF
+
+clean:
+	rm -f $(OBJECTS) $(RESOURCE) plugin.c *.pdb \
+	    $(PLUGIN_NAME).dll $(PLUGIN_NAME).dll.manifest $(PLUGIN_NAME).lib \
+	    $(PLUGIN_NAME).exp $(PLUGIN_NAME).rc
+
+distclean: clean
+
+maintainer-clean: distclean
+
+checkapi:
+	$(PERL) ../../tools/checkAPIs.pl -g abort -g termoutput $(DISSECTOR_SRC)
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/moduleinfo.h wireshark-1.2.2/plugins/backlog/moduleinfo.h
--- wireshark-1.2.2.orig/plugins/backlog/moduleinfo.h	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/moduleinfo.h	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,16 @@
+/* Included *after* config.h, in order to re-define these macros */
+
+#ifdef PACKAGE
+#undef PACKAGE
+#endif
+
+/* Name of package */
+#define PACKAGE "backlog"
+
+
+#ifdef VERSION
+#undef VERSION
+#endif
+
+/* Version number of package */
+#define VERSION "0.1"
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/moduleinfo.nmake wireshark-1.2.2/plugins/backlog/moduleinfo.nmake
--- wireshark-1.2.2.orig/plugins/backlog/moduleinfo.nmake	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/moduleinfo.nmake	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,28 @@
+#
+# $Id: moduleinfo.nmake 20161 2006-12-19 22:24:40Z jake $
+#
+
+# The name
+PACKAGE=backlog
+
+# The version
+MODULE_VERSION_MAJOR=0
+MODULE_VERSION_MINOR=1
+MODULE_VERSION_MICRO=0
+MODULE_VERSION_EXTRA=0
+
+#
+# The RC_VERSION should be comma-separated, not dot-separated, 
+# as per Graham Bloice's message in
+#
+#	http://www.ethereal.com/lists/ethereal-dev/200303/msg00283.html
+#
+# "The RC_VERSION variable in config.nmake should be comma separated. 
+# This allows the resources to be built correctly and the version
+# number to be correctly displayed in the explorer properties dialog
+# for the executables, and XP's tooltip, rather than 0.0.0.0."
+#
+
+MODULE_VERSION=$(MODULE_VERSION_MAJOR).$(MODULE_VERSION_MINOR).$(MODULE_VERSION_MICRO).$(MODULE_VERSION_EXTRA)
+RC_MODULE_VERSION=$(MODULE_VERSION_MAJOR),$(MODULE_VERSION_MINOR),$(MODULE_VERSION_MICRO),$(MODULE_VERSION_EXTRA)
+
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/packet-backlog.c wireshark-1.2.2/plugins/backlog/packet-backlog.c
--- wireshark-1.2.2.orig/plugins/backlog/packet-backlog.c	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/packet-backlog.c	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,323 @@
+#include "packet-backlog.h"
+
+#ifdef HAVE_CONFIG_H
+# include "config.h"
+#endif
+
+#include <epan/packet.h>
+#include <epan/prefs.h>
+#include <epan/expert.h>
+#include <epan/dissectors/packet-tcp.h>
+
+static void dissect_backlog(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree);
+static void dissect_backlog_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree);
+static guint get_backlog_message_len(packet_info *pinfo, tvbuff_t *tvb, int offset);
+static void backlog_parse_int_array(proto_tree *tree, tvbuff_t *tvb, guint32 *offset);
+
+static int proto_backlog = -1;
+
+static const value_string packettypenames[] = {
+	{ 1, "ACK" },
+	{ 2, "PING" },
+	{ 3, "PING-ACK" },
+	{ 10, "backlog" },
+	{ 11, "basestation" },
+	{ 20, "tos" },
+	{ 21, "tos1x" },
+	{ 30, "binary" },
+	{ 40, "vaisala" },
+	{ 0, NULL }
+};
+
+static const value_string tostypenames[] = {
+        { 0, "AM" },
+        { 0, NULL }
+};
+
+static int hf_backlog_pdu_length = -1;
+static int hf_backlog_pdu_type = -1;
+static int hf_backlog_pdu_timestamp = -1;
+static int hf_backlog_pdu_timestamp_fmt = -1;
+static int hf_backlog_pdu_intarray_integer = -1;
+static int hf_backlog_pdu_tos_msgtype = -1;
+static int hf_backlog_pdu_tos_destaddr = -1;
+static int hf_backlog_pdu_tos_linksrcaddr = -1;
+static int hf_backlog_pdu_tos_msglen = -1;
+static int hf_backlog_pdu_tos_groupid = -1;
+static int hf_backlog_pdu_tos_handlertype = -1;
+static int hf_backlog_pdu_tos_header_seqnr = -1;
+static int hf_backlog_pdu_tos_header_origid = -1;
+static int hf_backlog_pdu_tos_header_atime_low = -1;
+static int hf_backlog_pdu_tos_header_atime_high = -1;
+static int hf_backlog_pdu_tos_header_gentime_fmt = -1;
+static int hf_backlog_pdu_tos_payload = -1;
+static int hf_backlog_pdu_binary_pathname = -1;
+static int hf_backlog_pdu_binary_data = -1;
+static int hf_backlog_pdu_vaisala_element = -1;
+static int hf_backlog_pdu_data = -1;
+static gint ett_backlog = -1;
+
+void proto_register_backlog(void)
+{
+	static hf_register_info hf[] = {
+		{ &hf_backlog_pdu_length,
+			{ "Length", "backlog.length",
+			FT_UINT32, BASE_DEC,
+			NULL, 0x0,
+			NULL, HFILL }
+		},
+		{ &hf_backlog_pdu_type,
+			{ "Type", "backlog.type",
+			FT_UINT8, BASE_DEC,
+			VALS(packettypenames), 0x0,
+			NULL, HFILL }
+		},
+                { &hf_backlog_pdu_timestamp,
+                        { "Timestamp (as msecs since epoch)", "backlog.timestamp",
+                        FT_UINT64, BASE_DEC,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+		{ &hf_backlog_pdu_timestamp_fmt,
+			{ "Timestamp (as datetime string)", "backlog.timestamp.datetime",
+			FT_ABSOLUTE_TIME, BASE_NONE,
+			NULL, 0x0,
+			NULL, HFILL }
+		},
+                { &hf_backlog_pdu_tos_msgtype,
+                        { "Message type", "backlog.tos.msgtype",
+                        FT_UINT8, BASE_DEC,
+                        VALS(tostypenames), 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_destaddr,
+                        { "Destination address", "backlog.tos.destaddr",
+                        FT_UINT16, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_linksrcaddr,
+                        { "Link source address", "backlog.tos.linksrcaddr",
+                        FT_UINT16, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_msglen,
+                        { "Message length", "backlog.tos.msglen",
+                        FT_UINT8, BASE_DEC,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_groupid,
+                        { "Group ID", "backlog.tos.groupid",
+                        FT_UINT8, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_handlertype,
+                        { "AM handler type", "backlog.tos.handlertype",
+                        FT_UINT8, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_header_seqnr,
+                        { "Sequence number", "backlog.tos.header.seqnr",
+                        FT_UINT16, BASE_DEC,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_header_origid,
+                        { "Originator ID", "backlog.tos.header.origid",
+                        FT_UINT16, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_header_atime_low,
+                        { "Arrival time (low)", "backlog.tos.header.atime.low",
+                        FT_UINT16, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_header_atime_high,
+                        { "Arrival time (high)", "backlog.tos.header.atime.high",
+                        FT_UINT8, BASE_DEC_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_header_gentime_fmt,
+                        { "Generation time (as datetime string)", "backlog.tos.header.gentime.fmt",
+                        FT_ABSOLUTE_TIME, BASE_NONE,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_tos_payload,
+                        { "Payload", "backlog.tos.payload",
+                        FT_BYTES, BASE_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+		{ &hf_backlog_pdu_intarray_integer,
+			{ "Integer", "backlog.intarray.integer",
+			FT_UINT32, BASE_DEC_HEX,
+			NULL, 0x0,
+			NULL, HFILL }
+		},
+                { &hf_backlog_pdu_binary_pathname,
+                        { "Pathname of binary", "backlog.binary.pathname",
+                        FT_STRING, BASE_NONE,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_binary_data,
+                        { "Data", "backlog.binary.data",
+                        FT_BYTES, BASE_HEX,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+                { &hf_backlog_pdu_vaisala_element,
+                        { "Element", "backlog.vaisala.element",
+                        FT_STRING, BASE_NONE,
+                        NULL, 0x0,
+                        NULL, HFILL }
+                },
+		{ &hf_backlog_pdu_data,
+			{ "Undecoded data", "backlog.data",
+			FT_BYTES, BASE_HEX,
+			NULL, 0x0,
+			NULL, HFILL }
+		}
+	};
+
+	/* Setup protocol subtree array */
+	static gint *ett[] = {
+		&ett_backlog,
+	};
+
+	proto_backlog = proto_register_protocol (
+		"BackLog Protocol",	/* name       */
+		"backlog",		/* short name */
+		"backlog"		/* abbrev     */
+	);
+
+	proto_register_field_array(proto_backlog, hf, array_length(hf));
+	proto_register_subtree_array(ett, array_length(ett));
+}
+
+void proto_reg_handoff_backlog(void)
+{
+	static dissector_handle_t backlog_handle;
+
+	backlog_handle = create_dissector_handle(dissect_backlog, proto_backlog);
+	dissector_add("tcp.port", BACKLOG_PORT, backlog_handle);
+}
+
+static void dissect_backlog(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
+{
+	//dissect_backlog_message(tvb, pinfo, tree);
+	tcp_dissect_pdus(tvb, pinfo, tree, TRUE, BACKLOG_FRAME_HEADER_LEN, get_backlog_message_len, dissect_backlog_message);
+}
+
+static void dissect_backlog_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)
+{
+	guint8 packet_type = tvb_get_guint8(tvb, 4);
+
+	col_set_str(pinfo->cinfo, COL_PROTOCOL, "backlog");
+	//col_clear(pinfo->cinfo, COL_INFO);
+	col_prepend_fstr(pinfo->cinfo, COL_INFO, "Type %s, ", val_to_str(packet_type, packettypenames, "Unknown (0x%02x)"));
+
+	if (tree) { /* we are being asked for details */
+		int len;
+		guint32 offset = 0;
+		guint64 timestamp, atime;
+		nstime_t ts;
+		proto_item *ti = NULL;
+		proto_tree *backlog_tree = NULL;
+
+		ti = proto_tree_add_item(tree, proto_backlog, tvb, 0, -1, FALSE);
+		proto_item_append_text(ti, ", Type %s", val_to_str(packet_type, packettypenames, "Unknown (0x%02x)"));
+		backlog_tree = proto_item_add_subtree(ti, ett_backlog);
+		proto_tree_add_item(backlog_tree, hf_backlog_pdu_length, tvb, offset, 4, TRUE); offset +=4;
+		proto_tree_add_item(backlog_tree, hf_backlog_pdu_type, tvb, offset, 1, TRUE); offset +=1;
+		
+		timestamp = tvb_get_letoh64(tvb, offset);
+		if (timestamp) {
+			ts.secs = timestamp / 1000;
+			ts.nsecs = (timestamp % 1000) * 1000000;
+			proto_tree_add_item(backlog_tree, hf_backlog_pdu_timestamp, tvb, offset, 8, TRUE);
+			proto_tree_add_time(backlog_tree, hf_backlog_pdu_timestamp_fmt, tvb, offset, 8, &ts);
+		} else {
+			proto_tree_add_text(backlog_tree, tvb, offset, 8, "Timestamp: invalid");
+			expert_add_info_format(pinfo, ti, PI_MALFORMED, PI_WARN, "Timestamp is invalid!");
+		}
+		offset +=8;
+
+		switch (packet_type) {
+			case (10):
+				proto_tree_add_text(backlog_tree, tvb, offset, -1, "BackLog status payload ==============================================================");
+				backlog_parse_int_array(backlog_tree, tvb, &offset);
+				goto end;
+			case (11):
+				proto_tree_add_text(backlog_tree, tvb, offset, -1, "Basestation status payload ==========================================================");
+				backlog_parse_int_array(backlog_tree, tvb, &offset);
+				goto end;
+			case (20):
+				proto_tree_add_text(backlog_tree, tvb, offset, -1, "TOS payload =========================================================================");
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_msgtype, tvb, offset, 1, FALSE); offset +=1;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_destaddr, tvb, offset, 2, FALSE); offset +=2;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_linksrcaddr, tvb, offset, 2, FALSE); offset +=2;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_msglen, tvb, offset, 1, FALSE); offset +=1;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_groupid, tvb, offset, 1, FALSE); offset +=1;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_handlertype, tvb, offset, 1, FALSE); offset +=1;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_header_seqnr, tvb, offset, 2, FALSE); offset +=2;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_header_origid, tvb, offset, 2, FALSE); offset +=2;
+				atime = tvb_get_ntohs(tvb, offset);
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_header_atime_low, tvb, offset, 2, FALSE); offset +=2;
+				atime |= ((guint64) tvb_get_guint8(tvb, offset) << 16);
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_header_atime_high, tvb, offset, 1, FALSE); offset +=1;
+	                        ts.secs = (timestamp - (atime * 1000)) / 1000;
+				proto_tree_add_time(backlog_tree, hf_backlog_pdu_tos_header_gentime_fmt, tvb, offset-3, 3, &ts);
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_tos_payload, tvb, offset, -1, FALSE);
+				break;
+                        case (21):
+                                proto_tree_add_text(backlog_tree, tvb, offset, -1, "TOS1x payload =======================================================================");
+                                goto end;
+			case (30):
+				len = 0;
+				while (tvb_get_guint8(tvb, offset + len) != 0)
+					len++;
+				len++;
+				proto_tree_add_text(backlog_tree, tvb, offset, -1, "Binary payload ======================================================================");
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_binary_pathname, tvb, offset, len, TRUE); offset += len;
+				proto_tree_add_item(backlog_tree, hf_backlog_pdu_binary_data, tvb, offset, -1, TRUE);
+				break;
+			case (40):
+				proto_tree_add_text(backlog_tree, tvb, offset, -1, "Vaisala WXT520 payload ==============================================================");
+				while (offset < tvb_reported_length(tvb)) {
+					len = 0;
+                                	while (tvb_get_guint8(tvb, offset + len) != 0)
+                                        	len++;
+                                	len++;
+					proto_tree_add_item(backlog_tree, hf_backlog_pdu_vaisala_element, tvb, offset, len, TRUE); offset += len;
+				}
+				break;
+			default:
+end:
+				if (offset < tvb_reported_length(tvb)) {
+					proto_tree_add_item(backlog_tree, hf_backlog_pdu_data, tvb, offset, -1, TRUE);
+					expert_add_info_format(pinfo, ti, PI_UNDECODED, PI_WARN, "Undecoded data!");
+				}
+		}
+	}
+}
+
+static guint get_backlog_message_len(packet_info *pinfo, tvbuff_t *tvb, int offset)
+{
+	return (guint) (tvb_get_letohl(tvb, offset) + 4); /* length is at offset 0 */
+}
+
+static void backlog_parse_int_array(proto_tree *tree, tvbuff_t *tvb, guint32 *offset)
+{
+	while (*offset + 4 <= tvb_reported_length(tvb)) {
+		proto_tree_add_item(tree, hf_backlog_pdu_intarray_integer, tvb, *offset, 4, TRUE); *offset +=4;
+	}
+}
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/packet-backlog.h wireshark-1.2.2/plugins/backlog/packet-backlog.h
--- wireshark-1.2.2.orig/plugins/backlog/packet-backlog.h	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/packet-backlog.h	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,4 @@
+#define BACKLOG_PORT 9003
+
+#define BACKLOG_FRAME_HEADER_LEN 5
+
diff -Nurd wireshark-1.2.2.orig/plugins/backlog/plugin.rc.in wireshark-1.2.2/plugins/backlog/plugin.rc.in
--- wireshark-1.2.2.orig/plugins/backlog/plugin.rc.in	1970-01-01 01:00:00.000000000 +0100
+++ wireshark-1.2.2/plugins/backlog/plugin.rc.in	2009-11-26 15:35:30.000000000 +0100
@@ -0,0 +1,34 @@
+#include "winver.h"
+
+VS_VERSION_INFO VERSIONINFO
+ FILEVERSION @RC_MODULE_VERSION@
+ PRODUCTVERSION @RC_VERSION@
+ FILEFLAGSMASK 0x0L
+#ifdef _DEBUG
+ FILEFLAGS VS_FF_DEBUG
+#else
+ FILEFLAGS 0
+#endif
+ FILEOS VOS_NT_WINDOWS32
+ FILETYPE VFT_DLL
+BEGIN
+    BLOCK "StringFileInfo"
+    BEGIN
+        BLOCK "040904b0"
+        BEGIN
+            VALUE "CompanyName", "The Wireshark developer community, http://www.wireshark.org/\0"
+            VALUE "FileDescription", "@PACKAGE@ dissector\0"
+            VALUE "FileVersion", "@MODULE_VERSION@\0"
+            VALUE "InternalName", "@PACKAGE@ @MODULE_VERSION@\0"
+            VALUE "LegalCopyright", "Copyright © 1998 Gerald Combs <gerald@wireshark.org>, Gilbert Ramirez <gram@alumni.rice.edu> and others\0"
+            VALUE "OriginalFilename", "@PLUGIN_NAME@.dll\0"
+            VALUE "ProductName", "Wireshark\0"
+            VALUE "ProductVersion", "@VERSION@\0"
+            VALUE "Comments", "Build with @MSVC_VARIANT@\0"
+        END
+    END
+    BLOCK "VarFileInfo"
+    BEGIN
+        VALUE "Translation", 0x409, 1200
+    END
+END
diff -Nurd wireshark-1.2.2.orig/plugins/Makefile.am wireshark-1.2.2/plugins/Makefile.am
--- wireshark-1.2.2.orig/plugins/Makefile.am	2009-11-26 15:35:04.000000000 +0100
+++ wireshark-1.2.2/plugins/Makefile.am	2009-11-26 15:38:04.000000000 +0100
@@ -28,6 +28,7 @@
 	ethercat \
 	giop \
 	gryphon \
+	backlog \
 	irda \
 	m2m \
 	mate \
diff -Nurd wireshark-1.2.2.orig/plugins/Makefile.nmake wireshark-1.2.2/plugins/Makefile.nmake
--- wireshark-1.2.2.orig/plugins/Makefile.nmake	2009-11-26 15:35:04.000000000 +0100
+++ wireshark-1.2.2/plugins/Makefile.nmake	2009-11-26 15:42:28.000000000 +0100
@@ -45,6 +45,9 @@
 	cd gryphon
 	$(MAKE) /$(MAKEFLAGS) -f Makefile.nmake $(PLUGIN_TARGET)
 	cd ..
+	cd backlog
+	$(MAKE) /$(MAKEFLAGS) -f Makefile.nmake $(PLUGIN_TARGET)
+	cd ..
 	cd irda
 	$(MAKE) /$(MAKEFLAGS) -f Makefile.nmake $(PLUGIN_TARGET)
 	cd ..
@@ -90,6 +93,7 @@
 	xcopy plugins\ethercat\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
 	xcopy plugins\giop\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
 	xcopy plugins\gryphon\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
+	xcopy plugins\backlog\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
 	xcopy plugins\irda\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
 	xcopy plugins\m2m\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
 	xcopy plugins\mate\*.dll $(INSTALL_DIR)\plugins\$(VERSION) /d
