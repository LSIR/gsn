<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>GSN</title>
        
        <link rel="stylesheet" href="style/gsn.css" type="text/css" media="screen,projection" />
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery-dom.js"></script>
        <script type="text/javascript" src="js/jquery.history.js"></script>
        <script type="text/javascript" src="js/jquery.cookie.js"></script>
        <script type="text/javascript" src="js/uptime.js"></script>

        <!-- Visualization -->
        <link rel="stylesheet" type="text/css" href="http://vizzly.ethz.ch/vizzly.min.css" />
        <link rel="stylesheet" type="text/css" href="style/jquery-ui.custom.min.css" />
        <!--[if IE]><script src="http://vizzly.ethz.ch/excanvas.js"></script><![endif]-->
        <script type='text/javascript' src='js/jquery-ui.min.js'></script>
        <script type='text/javascript' src='http://vizzly.ethz.ch/extlib/dygraph-combined.js'></script>
        <script type='text/javascript' src='http://vizzly.ethz.ch/vizzly.min.js'></script>
        <script type='text/javascript' src='js/gsnplots.js'></script>

<script type="text/javascript">
<!--//<![CDATA[

$(document).ready(function() {
    $.get('/menu.jsp', {selected: "sensornetwork"}, function(data) {
      $('#navigation').html(data);
    }, 'html');
    $("#navigation ul a.local").bind("click",function() { return GSN.nav($(this).text()); });

    // plot configuration
    GsnPlots.setConfig([
      
      // OpenSense Data Latency
      { title:"Tram 1: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [3]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 1: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [3]
        }]
      },
      // OpenSense Data Latency
      { title:"Tram 2: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [4]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 2: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [4]
        }]
      },
      // OpenSense Data Latency
      { title:"Tram 3: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [5]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 3: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [5]
        }]
      },
      // OpenSense Data Latency
      { title:"Tram 4: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [6]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 4: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [6]
        }]
      },
      // OpenSense Data Latency
      { title:"Tram 5: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [7]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 5: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [7]
        }]
      },
      // OpenSense Data Latency
      { title:"Tram 6: Data Latency [ms]",
        signals: [{
          vsensor:"opensense_data_latency",
          field:["latency"],
          deviceId: [8]
        }]
      },
      // OpenSense Backlog num. entries
      { title:"Tram 6: BackLog DB [# of entries]",
        signals: [{
          vsensor:"opensense_backlogstatus_dynamic__mapped",
          field:["db_entries"],
          deviceId: [8]
        }]
      },
      
      // Dozer Health
      { title:"Dozer System Voltage",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["sysvoltage"],
          select:"sensornode[nodetype=1][position],sensornode[nodetype=3][position]"
        }]
      },
      { title:"Dozer SDI Voltage",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position]"
        }]
      },
      { title:"Aiguille du Midi Internal PV Temperature [Â°C]",
        signals: [{
          vsensor:"adm_cr1000",
          field:["panel_temp"],
          select:"sensornode[position=7],sensornode[position=8],sensornode[position=9]"
        }]
      },
      { title:"Aiguille du Midi Internal PV Voltage Sense [V]",
        signals: [{
          vsensor:"adm_cr1000",
          field:["battery"],
          select:"sensornode[position=7],sensornode[position=8],sensornode[position=9]"
        }]
      },
      { title:"Aiguille du Midi External PV Voltage Sense [V]",
        signals: [{
          vsensor:"adm_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=7],sensornode[position=8],sensornode[position=9]"
        }]
      },
      { title:"Dirruhorn PV Voltages",
        signals: [{
          vsensor:"dirruhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=0],sensornode[position=5],sensornode[position=10],sensornode[position=11],sensornode[position=12]"
        }]
      },
      { title:"Dirruhorn WGPS PV Voltages",
        signals: [{
          vsensor:"dirruhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=15],sensornode[position=17],sensornode[position=25],sensornode[position=27],sensornode[position=55],sensornode[position=62],sensornode[position=63],sensornode[position=64],sensornode[position=82],sensornode[position=83],sensornode[position=84]"
        }]
      },
      { title:"Grabengufer PV Voltages",
        signals: [{
          vsensor:"dirruhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=39],sensornode[position=41],sensornode[position=58],sensornode[position=66],sensornode[position=67]"
        }]
      },
      { title:"Grabengufer WGPS PV Voltages",
        signals: [{
          vsensor:"dirruhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=43],sensornode[position=44]"
        }]
      },
      { title:"Randa PV Voltages",
        signals: [{
          vsensor:"dirruhorn_corestationstatus_hardware__conv",
          field:["v_ext1","v_ext2"],
          select:"sensornode[position=8][iscorestation='true']"
        }]
      },
      { title:"Randa WGPS PV Voltages",
          signals: [{
            vsensor:"dirruhorn_dozer_nodehealth__conv",
            field:["sdivoltage"],
            select:"sensornode[position=6],sensornode[position=9],sensornode[position=70]"
          }]
        },
      { title:"Randa PV MATE3 Voltages",
        signals: [{
          vsensor:"dirruhorn_outbackmate3__conv",
          field:["port1_batt_v","port2_batt_v","port3_batt_v"],
          deviceId: [9000]
        }]
      },
      { title:"Randa PV SOC",
        signals: [{
          vsensor:"dirruhorn_outbackmate3__conv",
          field:["port3_soc"],
          deviceId: [9000]
        }]
      },
      { title:"Randa PV Currents",
        signals: [{
          vsensor:"dirruhorn_outbackmate3__conv",
          field:["port1_out_i","port1_in_v","port2_out_i","port2_in_v","port3_shunt_a_i","port3_shunt_b_i","port3_shunt_c_i"],
          deviceId: [9000]
        }]
      },
      { title:"Randa PV Net Balance",
        signals: [{
          vsensor:"dirruhorn_outbackmate3__conv",
          field:["port3_in_ah_today","port3_out_ah_today","port3_in_kwh_today","port3_out_kwh_today","port3_net_cfc_ah","port3_net_cfc_kwh"],
          deviceId: [9000]
        }]
      },
//       {  title:"GPS Logger PV Voltage [mV]",
//          signals: [{
//           vsensor:"dirruhorn_gps_logger__status",
//           field:["v12dc_in"],
//           position: [14,15,16,17,18,19,21,23,25,27,29,31,33,35,40,43,44,55,56,57,62,63,64],
//         }],
//       },
      {  title:"GPS Logger PV Voltage [mV]",
         signals: [{
          vsensor:"permos_gps_logger__status",
          field:["v12dc_in"],
          position: [1,2,3,4,5,6,7,8,9,10],
        }],
      },
      { title:"Matterhorn PV Voltages",
        signals: [{
          vsensor:"matterhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=0],sensornode[position=14],sensornode[position=19],sensornode[position=23],sensornode[position=26],sensornode[position=28],sensornode[position=32],sensornode[position=31],sensornode[position=37],sensornode[position=39],sensornode[position=40]"
        }]
      },
      { title:"Matterhorn WGPS Voltages",
        signals: [{
          vsensor:"matterhorn_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=33],sensornode[position=34],sensornode[position=35]"
        }]
      },
      { title:"Saastal WGPS Voltages",
          signals: [{
            vsensor:"saastal_dozer_nodehealth__conv",
            field:["sdivoltage"],
            select:"sensornode[position=2],sensornode[position=3]"
        }]
      },
      { title:"Jungfraujoch PV Voltages",
        signals: [{
          vsensor:"jungfraujoch_dozer_nodehealth__conv",
          field:["sdivoltage"],
          select:"sensornode[position=19],sensornode[position=20],sensornode[position=21],sensornode[position=23],sensornode[position=24]"
        }]
      },
       { title:"Weather Station Voltages",
         signals: [{
           vsensor:"dirruhorn_vaisalawxt520sup",
           field:["heating_voltage","supply_voltage","heating_temperature"],
           select:"sensornode[position=13],sensornode[position=42],sensornode[position=68]"
         }]
       },
       { title:"Weather Station Voltages",
         signals: [{
           vsensor:"matterhorn_vaisalawxt520sup",
           field:["heating_voltage","supply_voltage","heating_temperature"],
           select:"sensornode[position=25]"
         }]
      },
      { title:"Dozer Temperature [Â°C]",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["temperature"],
          select:"sensornode[position]"
        }]
      },
      {  title:"GPS Logger Temperature [Â°C]",
         signals: [{
          vsensor:"permos_gps_logger__status",
          field:["temperature"],
          position: [1,2,3,4,5,6,7,8,9,10],
        }],
      },
//       {  title:"GPS Logger Temperature [Â°C]",
//          signals: [{
//           vsensor:"dirruhorn_gps_logger__status",
//           field:["temperature"],
//           position: [14,15,16,17,18,19,21,23,25,27,29,31,33,35,40,43,44,55,56,57,62,63,64],
//         }],
//       },
      { title:"Dozer Humidity [%]",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["humidity"],
          select:"sensornode[position]"
        }]
      },
      {  title:"GPS Logger Humidity [%]",
         signals: [{
          vsensor:"permos_gps_logger__status",
          field:["humidity"],
          position: [1,2,3,4,5,6,7,8,9,10],
        }],
      },
//       {  title:"GPS Logger Humidity [%]",
//          signals: [{
//           vsensor:"dirruhorn_gps_logger__status",
//           field:["humidity"],
//           position: [14,15,16,17,18,19,21,23,25,27,29,31,33,35,40,43,44,55,56,57,62,63,64],
//         }],
//       },
      { title:"Dozer Current",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["current"],
          select:"sensornode[position]"
        }]
      },
//       { title:"Dozer Sequence number (node health)",
//         signals: [{
//           vsensor:".*_dozer_nodehealth__conv",
//           field:["header_seqnr"],
//           select:"sensornode[position]"
//         }]
//       },
      { title:"Dozer Queuesize",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["payload_queuesize"],
          select:"sensornode[position]"
        }]
      },
      { title:"Dozer Uptime",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["payload_uptime"],
          select:"sensornode[position]"
        }]
      },
      { title:"Dozer Flashstatus",
        signals: [{
          vsensor:".*_dozer_nodehealth__conv",
          field:["payload_flashstatus"],
          select:"sensornode[position]"
        }]
      },
      { title:"Dozer MCU Active",
        signals: [{
          vsensor:".*_dozer_statecounter__conv",
          field:["mcuactive_dutycycle"],
          select:"sensornode[position]"
        }]
      },
      { title:"Dozer Radio TX",
        signals: [{
          vsensor:".*_dozer_statecounter__conv",
          field:["radiotx_dutycycle"],
          select:"sensornode[position]"
        }]
      },
      { title:"Dozer Radio RX",
        signals: [{
          vsensor:".*_dozer_statecounter__conv",
          field:["radiorx_dutycycle"],
          select:"sensornode[position]"
        }]
      },
//       { title:"Powerswitch Portstate",
//         signals: [{
//           vsensor:".*_dozer_powerswitch__mapped",
//           field:["payload_port1on","payload_port2on"],
//           select:"sensornode[nodetype=3][position]"
//         }]
//       },
//       { title:"BackLog Uptime",
//         signals: [{
//           vsensor:".*_backlogstatus_dynamic__mapped",
//           field:["uptime"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"BackLog Error/Exception Counters",
//         signals: [{
//           vsensor:".*_backlogstatus_dynamic__mapped",
//           field:["error_counter","exception_counter"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"BackLog Database Store Time",
//         signals: [{
//           vsensor:".*_backlogstatus_dynamic__mapped",
//           field:["db_store_time_min","db_store_time_mean","db_store_time_max"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"CoreStation Uptime",
//         signals: [{
//           vsensor:".*_corestationstatus_software__mapped",
//           field:["uptime"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"CoreStation Load",
//         signals: [{
//           vsensor:".*_corestationstatus_software__mapped",
//           field:["loadavg_1_min","loadavg_5_min","loadavg_15_min"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"CoreStation Card File System",
//         signals: [{
//           vsensor:".*_corestationstatus_software__mapped",
//           field:["statvfs_card_size","statvfs_card_free"],
//           select:"sensornode[position][iscorestation='true']"
//         }]
//       },
//       { title:"CamZilla Binary Queue",
//           signals: [{
//           vsensor:".*[^_]_binary__mapped",
//           field:["file_queue_length","file_queue_size"],
//           select:"sensornode[nodetype=6][position]"
//         }]
//       },
//       { title:"CamZilla Binary Transmission Time",
//         signals: [{
//           vsensor:".*[^_]_binary__mapped",
//           field:["transmission_time_eff","transmission_time_tot"],
//           select:"sensornode[nodetype=6][position]"
//         }]
//       },
    ]);
    
    $.ajax({
      type: "GET",
      url: "/gsn?structure",
      success: function(data){
        if ($(document).attr("title")=="GSN") {
          var gsn = $("gsn",data);
          $(document).attr("title",$(gsn).attr("name"));
          $("#gsn-name").empty().append($(gsn).attr("name"));
          $("#gsn-desc").empty().append($(gsn).attr("description"));
          $("#gsn-author").empty().append($(gsn).attr("author")+" ("+$(gsn).attr("email")+")");
          var gsnname = $(gsn).attr("name").replace(/.*::\s*GSN\s*-\s*/, "").replace(/\s/g,"").toLowerCase();
          $('head', document).append('<link rel="shortcut icon" href="/img/favicon/permasense-'+gsnname+'.ico"><link rel="icon" href="/img/favicon/permasense-'+gsnname+'.ico">');
        }
        $("#gsn-name").show();
        uptime.setTime($(gsn).attr("uptime"));
        GsnPlots.initPlots(data, function(){addDeployments();});
      }
    });
});

function addDeployments() {
  // add deployment tabs and container
  var visible=-1;
  var d = GsnPlots.getDeployments(".*","Statistics");
  $(d).each(function() {
    if ($.cookie("deployment")==this)
      visible = this;
  });
  if (visible==-1) {
      visible = d[0];
  }
  $(d).each(function() {
    $('#deployment_menu').append('<li><a href="javascript:showPlots(\''+this+'\')" id="deployment_menu_item_'+this+'">'+this+'</a></li>');
    $('#plotscontainer').append('<div id="plot_'+this+'"></div>');
    $('#plot_'+this).hide();
  });
  showPlots(visible);
}

function showPlots(id) {
  $(GsnPlots.getDeployments(".*","Statistics")).each(function() {
      $("#plot_"+this).empty().hide();
      $("#deployment_menu_item_"+this).removeClass("selected");
  });
  $("#plot_"+id).show();
  $("#deployment_menu_item_"+id).addClass("selected");
  // add graphs
  GsnPlots.addPlots($("#plot_"+id), id)
  $.cookie("deployment" , id);
}	
//]]>-->
</script>
</head>
<body>

<div id="container">
	<div id="header">
		<h1><a href="." id="gsn-name" style="display:none">GSN</a></h1>
		<div id="breadcrumbnav"><a href="http://www.permasense.ch">PermaSense</a> > <a href="." id="gsn-name">GSN</a> > Sensor Network</div>
	</div>
	<div id="navigation">
	</div>
	
	<div id="separator">
		<div id="starttext">
			<p>
				A collection of sensor network specific plots related to the PermaSense Deployments.
			</p>
		</div>
	</div>

	<div id="maindiv">
		<div id="deployment_navigation">
		<ul id="deployment_menu">
		<li />
		</ul>
		</div>	
		
		<div id="plotscontainer" style="margin-top:5px"></div>
		
	</div>
	<div class="separator">
		<div id="footer">
		      <table width="100%">
				<tr>
					<td style="width:50%;color:#444444;"><b>A Project of <a href="http://www.ethz.ch" target="_blank">ETH Zurich</a>, <a href="http://www.unibas.ch" target="_blank">Uni Basel</a> and <a href="http://www.uzh.ch" target="_blank">Uni Zurich</a></b></td>
					<td style="text-align:right;width:50%;font-size:9px;">Powered by <a href="http://gsn.sourceforge.net/">GSN</a>,  Distributed Information Systems Lab, EPFL 2006</td>
				</tr>
			</table>
		</div>
	</div>
</div>
<!-- script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5632004-2");
pageTracker._initData();
pageTracker._trackPageview();
</script -->
</body>
</html>
